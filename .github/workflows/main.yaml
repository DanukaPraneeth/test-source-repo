name: Continuous Integration

on: push
    
jobs:
    replicate-file:
        runs-on: ubuntu-latest
        name: Replicate File
        
        steps:
        - name: Checkout main-project
          uses: actions/checkout@v2
          with:
            path: ./

        - name: Come back
          run: |
            ls -ltr
            ls -ltr ../
            pwd


        - name: Checkout source-project
          uses: actions/checkout@v2
          with: 
            repository: DanukaPraneeth/test-source-repo
            token: ${{ secrets.MY_TOKEN || github.token }}
            path: ./

        - name: Copy file
          run: |
            ls -ltr
            ls -ltr ../
            pwd
#            cp -r ./test-source-repo/* ./test-target-repo/
            
        - uses: actions/checkout@v2
          with:
            token: ${{ secrets.MY_TOKEN || github.token }}

        - name: Push To Repo2
          run: |
            ls -ltr
            ls -ltr ../
            pwd
            echo "Test" > testfile
            cp -r ./test-source-repo/* ./
            rm -rf ./test-source-repo
            git add .
            git config user.name "DanukaPraneeth"
            git config user.email “danuka@gmail.com”
            git checkout -b update-form
            git commit -am "Update files"
            git push --set-upstream origin update-form
            
        - name: pull-request
          uses: repo-sync/pull-request@v2
          with:
            destination_branch: "main" 
            source_branch: "update-form"
            
